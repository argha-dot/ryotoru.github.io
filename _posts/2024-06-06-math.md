---
layout: post
title: Lattices and Learning With Errors (LWE)
date: 2024-06-12 11:12:00-0400
description: What is a lattice?
tags: formatting math
categories: posts
related_posts: false
---

**Introduction**

Learning With Errors (LWE) is a fundamental problem in lattice-based cryptography, which forms the basis for many cryptographic protocols due to its conjectured hardness. This blog post aims to provide a comprehensive understanding of LWE, including its mathematical background, key concepts, and computational problems associated with it. 

**Mathematical Background**

A lattice in $$ \mathbb{R}^n $$ is the set:
$$
L(b_1, ..., b_n) = \left\{ \sum_{i=1}^n x_i b_i : x_i \in \mathbb{Z} \right\}
$$
of all integral combinations of $$ n $$ linearly independent vectors $$ (b_1, ..., b_n) $$ in $$ \mathbb{R}^n $$. These vectors form the lattice basis and can be represented as a matrix:
$$
B = [b_1, ..., b_n] \in \mathbb{R}^{n \times n}
$$
Thus, a lattice $$ L $$ can be represented as:
$$
L(B) = \{ Bx : x \in \mathbb{Z}^n \}
$$

**Graphical Representation and Dual Lattice**

Graphically, a lattice is the set of intersection points of an infinite, regular, not necessarily orthogonal, $$ n $$-dimensional grid.

The dual lattice $$ \Lambda^* $$ is defined as the set of all vectors $$ y \in \mathbb{R}^n $$ such that $$ \langle x, y \rangle \in \mathbb{Z} $$ for all vectors $$ x $$ in the lattice $$ \Lambda $$.

**Discrete Gaussian Distribution**

The discrete Gaussian distribution on a lattice $$ \Lambda $$ with parameter $$ t $$, denoted $$ D_{\Lambda, t} $$, assigns mass proportional to $$ e^{-\pi \|x/t\|^2} $$ to each point $$ x \in \Lambda \}. Samples from $$ D_{\Lambda, t} $$ are lattice vectors with a norm approximately $$ \sqrt{nt} $$.

**Fundamental Parallelepiped and Determinant of Lattice**

The fundamental parallelepiped $$ P(B) $$ for a matrix $$ B $$ is defined as:
$$
P(B) = \{ Bx : x \in [0, 1)^n \}
$$
The determinant of a lattice $$ L(B) $$, denoted $$ \text{det}(L) $$, is the $$ n $$-dimensional volume of the fundamental parallelepiped and is given by $$ |\text{det}(B)| $$.

**Minkowski’s Theorems**

Minkowski’s first theorem states that for any lattice $$ L $$ of rank $$ n $$ and any convex set $$ S \subset \text{span}(L) $$ symmetric about the origin, if $$ \text{vol}(S) > 2^n \text{det}(L) $$, then $$ S $$ contains a nonzero lattice point $$ v \in S \cap L \setminus \{0\} $$.

Minkowski’s second theorem provides bounds on the successive minima $$ \lambda_i $$ of a lattice $$ L $$:
$$
\left( \prod_{i=1}^n \lambda_i \right)^{1/n} < \sqrt{n} \text{det}(B)^{1/n}
$$

**Computational Problems**

Two primary computational problems in lattice-based cryptography are:

1. **Shortest Vector Problem (SVP):** Given a basis $$ B $$ of a lattice $$ L(B) $$, find the shortest nonzero vector $$ v \in L $$ such that $$ \|v\| = \lambda_1(L) $$.
2. **Closest Vector Problem (CVP):** Given a lattice basis $$ B $$ and a target vector $$ t $$, find a lattice vector $$ Bx $$ closest to $$ t $$.

**Bounded Distance Decoding**

Bounded distance decoding (BDD$$_\gamma$$) involves finding a unique lattice vector $$ v \in L $$ such that $$ \|t - v\| < d $$ given the basis $$ B $$ and a target point $$ t $$ with the guarantee that $$ \text{dist}(t, L) < d = \lambda_1(L)/(2\gamma(n)) $$.

**Approximation Problems**

Approximation problems are critical for lattice-based cryptography and are parameterized by an approximation factor $$ \gamma \geq 1 $$, which is a function of the lattice dimension $$ n $$.

1. **Approximate Shortest Vector Problem (SVP$$_\gamma$$):** Given a basis $$ B $$ of a lattice $$ L(B) $$, find a nonzero vector $$ v \in L $$ such that $$ \|v\| \leq \gamma(n) \lambda_1(L) $$.

2. **Decisional Approximate SVP (GapSVP$$_\gamma$$):** Given a basis $$ B $$ of a lattice $$ L(B) $$, determine whether $$ \lambda_1(L) \leq 1 $$ or $$ \lambda_1(L) > \gamma(n) $$.

**Learning With Errors (LWE) Problem**

The LWE problem involves the following parameters:
- Integers $$ n $$ and $$ q $$
- Error distribution $$ \chi $$ over $$ \mathbb{Z} $$
- Number of samples $$ m $$

Given a vector $$ r \in \mathbb{Z}_q^n $$ (the secret), the LWE distribution $$ A_{r,\chi} $$ over $$ \mathbb{Z}_q^n \times \mathbb{Z}_q $$ is sampled by choosing $$ a \in \mathbb{Z}_q^n $$ uniformly at random and $$ e \leftarrow \chi $$, resulting in pairs $$ (a, b = \langle r, a \rangle + e \mod q) $$.

The LWE problem has two main versions:
1. **Search Problem:** Given samples $$ (a_i, b_i) $$, find the secret $$ r $$.
2. **Decision Problem:** Determine whether given samples are from the LWE distribution or are uniformly random.

**LWE Cryptosystem**

In the LWE cryptosystem:
- The secret key is a uniformly random LWE secret $$ r \in \mathbb{Z}_q^n $$.
- The public key consists of $$ m $$ samples $$ (a_i, b_i = \langle r, a_i \rangle + e_i) $$.
- Encryption and decryption processes involve matrix operations and leveraging the hardness of the LWE problem.

**Conclusion**

The LWE problem is foundational to modern cryptography due to its hardness and versatility in constructing secure cryptographic schemes. This blog post covers the essential mathematical concepts and computational problems associated with LWE, providing a solid foundation for further exploration into lattice-based cryptography.
